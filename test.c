#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <stdint.h>

unsigned char rr[169] = {
	0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x03, 0x04, 0x01, 0x00, 0x01, 0x7F,
	0x00, 0x01, 0x04, 0x00, 0x02, 0x10, 0x02, 0x19, 0x00, 0x01, 0x02, 0x03,
	0x01, 0xCE, 0x10, 0x10, 0x02, 0x00, 0x1D, 0x01, 0x01, 0x20, 0x00, 0x00,
	0x20, 0x00, 0x00, 0x00, 0x00, 0x00, 0x04, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x00, 0x00, 0x23, 0x02, 0x00, 0x01, 0x00, 0x00, 0x00, 0x00,
	0x00, 0x00, 0x0C, 0x00, 0x00, 0x00, 0x00, 0x01, 0xDC, 0xB0, 0x00, 0x00,
	0x00, 0x00, 0x01, 0x03, 0x00, 0x00, 0x00, 0x00, 0x01, 0xDC, 0xB0, 0x00,
	0x00, 0x00, 0x00, 0x23, 0x02, 0x01, 0x01, 0x01, 0x01, 0x00, 0x00, 0x03,
	0x00, 0x0C, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x04, 0x00, 0x00, 0x00,
	0x00, 0x01, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x04, 0x00, 0x00,
	0x00, 0x00, 0x23, 0x02, 0x02, 0x01, 0x02, 0x01, 0x00, 0x00, 0x03, 0x00,
	0x0C, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x04, 0x00, 0x00, 0x00, 0x00,
	0x01, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x04, 0x00, 0x00, 0x00,
	0x00
};

unsigned int swap_uint32(unsigned int val) {
	val = ((val << 8) & 0xFF00FF00 ) | ((val >> 8) & 0xFF00FF);
	return ((val << 16) | (val >> 16)) & 0xffffffff;
}

int main(void)
{
	uint8_t ufs_desc_sz = 0;
	unsigned long lun0_sz = 0;

	memcpy(&ufs_desc_sz, rr, 1);
	memcpy(&lun0_sz, rr + ufs_desc_sz + 0x1c, 4);

	lun0_sz = swap_uint32(lun0_sz);
	lun0_sz *= 4096;
	lun0_sz /= 1024;

	printf("%lu\n", lun0_sz);

	return 0;
}

